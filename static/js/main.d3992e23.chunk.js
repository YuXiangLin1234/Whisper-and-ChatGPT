(this.webpackJsonpchatgpt=this.webpackJsonpchatgpt||[]).push([[0],{10:function(e,t,n){},28:function(e,t,n){},34:function(e,t,n){"use strict";n.r(t);var c=n(2),s=n.n(c),a=n(17),r=n.n(a),i=(n(28),n(4)),o=(n(10),n(8)),l=n(5),u=n(6),j=n(18),p=n(35);function b(e){return e.toString().padStart(2,"0")}function d(e){return[b(e.getMonth()+1),b(e.getDate())].join("/")+" "+[b(e.getHours()),b(e.getMinutes()),b(e.getSeconds())].join(":")}function h(e){return O.apply(this,arguments)}function O(){return(O=Object(u.a)(Object(l.a)().mark((function e(t){var n,c;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"gpt-3.5-turbo","https://api.openai.com/v1/chat/completions",e.prev=2,n={"content-type":"application/json",Authorization:"Bearer ".concat(t)},c={messages:[{role:"user",content:"Hello!"}],model:"gpt-3.5-turbo"},e.next=8,p.a.post("https://api.openai.com/v1/chat/completions",c,{headers:n});case 8:return e.sent,e.abrupt("return",!0);case 12:return e.prev=12,e.t0=e.catch(2),console.log(e.t0),e.abrupt("return",!1);case 16:case"end":return e.stop()}}),e,null,[[2,12]])})))).apply(this,arguments)}var m=n(1),v=function(){return Object(m.jsxs)("div",{className:"spinner",children:[Object(m.jsx)("div",{className:"bounce1"}),Object(m.jsx)("div",{className:"bounce2"}),Object(m.jsx)("div",{className:"bounce3"})]})},x=function(e){var t=e.audio,n=e.transcription,s=e.translation,a=e.chat,r=Object(c.useState)(""),o=Object(i.a)(r,2),l=o[0],u=o[1],j=Object(c.useState)(""),p=Object(i.a)(j,2),b=p[0],h=p[1],O=Object(c.useState)(""),x=Object(i.a)(O,2),f=x[0],g=x[1];return Object(c.useEffect)((function(){var e=new Date;u(d(e))}),[n]),Object(c.useEffect)((function(){var e=new Date;h(d(e))}),[s]),Object(c.useEffect)((function(){var e=new Date;g(d(e))}),[a]),Object(m.jsx)("div",{style:{margin:"20px"},children:Object(m.jsxs)("div",{className:"msg-page",children:[Object(m.jsxs)("div",{className:"sent-chats",children:[Object(m.jsxs)("div",{className:"sent-chats-msg",children:[null!==t?Object(m.jsx)("audio",{controls:"True",src:t}):Object(m.jsx)(v,{}),null!==n?Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("p",{children:n}),Object(m.jsx)("span",{className:"chat-time",children:l})]}):null!==t?Object(m.jsx)(v,{}):Object(m.jsx)(m.Fragment,{})]}),Object(m.jsx)("div",{className:"sent-chats-img",children:Object(m.jsx)("img",{className:"chats-img",src:"old.png"})})]}),Object(m.jsx)("div",{className:"received-chats",children:null!==s?Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("div",{className:"received-chats-img",children:Object(m.jsx)("img",{className:"chats-img",src:"chatgpt.png"})}),Object(m.jsx)("div",{className:"received-msg",children:Object(m.jsxs)("div",{className:"received-msg-inbox",children:[Object(m.jsx)("p",{children:s}),Object(m.jsx)("span",{className:"chat-time",children:b})]})})]}):null!==n?Object(m.jsx)(v,{}):Object(m.jsx)(m.Fragment,{})}),Object(m.jsx)("div",{className:"received-chats",children:null!==a?Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("div",{className:"received-chats-img",children:Object(m.jsx)("img",{className:"chats-img",src:"chatgpt.png"})}),Object(m.jsx)("div",{className:"received-msg",children:Object(m.jsxs)("div",{className:"received-msg-inbox",children:[Object(m.jsx)("p",{children:a}),Object(m.jsx)("span",{className:"chat-time",children:f})]})})]}):null!==s?Object(m.jsx)(v,{}):Object(m.jsx)(m.Fragment,{})})]})})},f=function(e){var t=e.apiKey,n=Object(c.useState)([]),s=Object(i.a)(n,2),a=s[0],r=s[1],b=Object(c.useState)([]),d=Object(i.a)(b,2),h=d[0],O=d[1],v=Object(c.useState)([]),f=Object(i.a)(v,2),g=f[0],y=f[1],N=Object(c.useState)([]),w=Object(i.a)(N,2),k=w[0],S=w[1],F=Object(c.useState)(!1),A=Object(i.a)(F,2),C=(A[0],A[1],"gpt-3.5-turbo"),E="https://api.openai.com/v1/chat/completions",T=function(){var e=Object(u.a)(Object(l.a)().mark((function e(n){var c,s,a,r;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c={"content-type":"multipart/form-data",Authorization:"Bearer ".concat(t)},(s=new FormData).append("file",n,"audio.mp3"),s.append("model","whisper-1"),e.next=7,p.a.post("https://api.openai.com/v1/audio/transcriptions",s,{headers:c});case 7:return a=e.sent,r=a.data.text,e.abrupt("return",r);case 12:e.prev=12,e.t0=e.catch(0),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}();function D(e){return B.apply(this,arguments)}function B(){return(B=Object(u.a)(Object(l.a)().mark((function e(n){var c,s,a,r;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c={"content-type":"application/json",Authorization:"Bearer ".concat(t)},s={messages:[{role:"system",content:"Translate from English to Traditional Chinese"},{role:"user",content:n}],model:C},e.next=6,p.a.post(E,s,{headers:c});case 6:return a=e.sent,console.log(a),r=a.data.choices[0].message.content,e.abrupt("return",r);case 12:e.prev=12,e.t0=e.catch(0),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})))).apply(this,arguments)}function K(e){return R.apply(this,arguments)}function R(){return(R=Object(u.a)(Object(l.a)().mark((function e(n){var c,s,a,r,i,o;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(e.prev=0,c={"content-type":"application/json",Authorization:"Bearer ".concat(t)},s=[{role:"system",content:"You are a helpful assistant."}],console.log(g),a=0;a<g.length;a++)s.push({role:"user",content:g[a]}),s.push({role:"assistant",content:k[a]});return s.push({role:"user",content:n}),console.log(s),r={messages:s,model:C},e.next=10,p.a.post(E,r,{headers:c});case 10:return i=e.sent,console.log(i),o=i.data.choices[0].message.content,e.abrupt("return",o);case 16:e.prev=16,e.t0=e.catch(0),console.log(e.t0);case 19:case"end":return e.stop()}}),e,null,[[0,16]])})))).apply(this,arguments)}function z(e,t){return L.apply(this,arguments)}function L(){return(L=Object(u.a)(Object(l.a)().mark((function e(t,n){var c,s,a;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T(n);case 2:return c=e.sent,O([].concat(Object(o.a)(h),[c])),e.next=6,D(c);case 6:return s=e.sent,y([].concat(Object(o.a)(g),[s])),e.next=10,K(s);case 10:a=e.sent,S([].concat(Object(o.a)(k),[a]));case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var P=function(){var e=Object(u.a)(Object(l.a)().mark((function e(t){var n;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=URL.createObjectURL(t),r([].concat(Object(o.a)(a),[n])),O([].concat(Object(o.a)(h),[null])),y([].concat(Object(o.a)(g),[null])),S([].concat(Object(o.a)(k),[null])),e.next=7,z(n,t);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(m.jsxs)("div",{className:"App",style:{marginTop:"30px"},children:[Object(m.jsx)("div",{className:"msg-container",children:a.map((function(e,t){return Object(m.jsx)(x,{audio:a[t],transcription:h[t],translation:g[t],chat:k[t]},t)}))}),Object(m.jsx)("div",{className:"bottom-line"}),Object(m.jsxs)("div",{className:"bottom-line-button",children:[Object(m.jsx)(j.a,{onRecordingComplete:P}),Object(m.jsx)("button",{className:"circle-button",disabled:!1,onClick:function(){r([]),O([]),y([]),S([])},children:Object(m.jsx)("ion-icon",{name:"trash",style:{fontSize:"17px"}})})]})]})},g=function(e){var t=e.setApiKey,n=Object(c.useRef)(),s=Object(c.useRef)(),a=function(){var e=Object(u.a)(Object(l.a)().mark((function e(n){var c;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Enter"!==n.key){e.next=13;break}return e.prev=1,c=n.target.value,e.next=5,h(c);case 5:1==e.sent?t(n.target.value):s.current.style.visibility="visible",e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),s.current.style.visibility="visible",console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),r=function(){var e=Object(u.a)(Object(l.a)().mark((function e(c){var a;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=n.current.value,e.next=4,h(a);case 4:!0===e.sent?t(n.current.value):s.current.style.visibility="visible",e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),s.current.style.visibility="visible",console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}();return Object(m.jsxs)("div",{className:"App ask-key-container",children:[Object(m.jsx)("h2",{children:"Whisper & ChatGPT \u8853\u524d\u554f\u8a3a\u7cfb\u7d71"}),Object(m.jsxs)("span",{children:["Api Key : ",Object(m.jsx)("input",{type:"text",onKeyDown:a,ref:n})]}),Object(m.jsx)("button",{onClick:r,children:"\u78ba\u8a8d"}),Object(m.jsxs)("div",{className:"error",ref:s,style:{visibility:"hidden"},children:[Object(m.jsx)("h3",{style:{color:"red"},children:"Error!"}),Object(m.jsx)("p",{style:{color:"red"},children:"Please ensure that a correct api key is provided"})]})]})},y=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"anonymous";Object(c.useEffect)((function(){var c=document.createElement("script");return c.src=e,c.async=n,t&&(c.integrity=t),c.crossOrigin=s,document.body.appendChild(c),function(){document.body.removeChild(c)}}),[e,t,n,s])};var N=function(){y("https://cdn.jsdelivr.net/npm/ionicons/dist/ionicons/ionicons.js");var e=Object(c.useState)(""),t=Object(i.a)(e,2),n=t[0],s=t[1];return Object(m.jsx)("div",{className:"App",style:{marginTop:"30px"},children:n.length?Object(m.jsx)(f,{apiKey:n}):Object(m.jsx)(g,{setApiKey:s})})},w=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,36)).then((function(t){var n=t.getCLS,c=t.getFID,s=t.getFCP,a=t.getLCP,r=t.getTTFB;n(e),c(e),s(e),a(e),r(e)}))};r.a.createRoot(document.getElementById("root")).render(Object(m.jsx)(s.a.StrictMode,{children:Object(m.jsx)(N,{})})),w()}},[[34,1,2]]]);
//# sourceMappingURL=main.d3992e23.chunk.js.map