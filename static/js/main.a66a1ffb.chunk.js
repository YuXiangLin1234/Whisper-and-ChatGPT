(this.webpackJsonpchatgpt=this.webpackJsonpchatgpt||[]).push([[0],{27:function(e,t,c){},33:function(e,t,c){"use strict";c.r(t);var n=c(2),s=c.n(n),a=c(17),r=c.n(a),i=(c(27),c(4)),o=(c(9),c(8)),j=c(7),l=c(16),u=c(18),p=c(35);function b(e){return e.toString().padStart(2,"0")}var d=function(e){return[b(e.getMonth()+1),b(e.getDate())].join("/")+" "+[b(e.getHours()),b(e.getMinutes()),b(e.getSeconds())].join(":")},O=c(1),h=function(){return Object(O.jsxs)("div",{className:"spinner",children:[Object(O.jsx)("div",{className:"bounce1"}),Object(O.jsx)("div",{className:"bounce2"}),Object(O.jsx)("div",{className:"bounce3"})]})},x=function(e){var t=e.audio,c=e.transcription,s=e.text,a=Object(n.useState)(""),r=Object(i.a)(a,2),o=r[0],j=r[1],l=Object(n.useState)(""),u=Object(i.a)(l,2),p=u[0],b=u[1];return Object(n.useEffect)((function(){var e=new Date;j(d(e))}),[c]),Object(n.useEffect)((function(){var e=new Date;b(d(e))}),[s]),Object(O.jsx)("div",{style:{margin:"20px"},children:Object(O.jsxs)("div",{className:"msg-page",children:[Object(O.jsxs)("div",{className:"sent-chats",children:[Object(O.jsxs)("div",{className:"sent-chats-msg",children:[null!==t?Object(O.jsx)("audio",{controls:"True",src:t}):Object(O.jsx)(h,{}),null!==c?Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)("p",{children:c}),Object(O.jsx)("span",{className:"chat-time",children:o})]}):null!==t?Object(O.jsx)(h,{}):Object(O.jsx)(O.Fragment,{})]}),Object(O.jsx)("div",{className:"sent-chats-img",children:Object(O.jsx)("img",{className:"chats-img",src:"old.png"})})]}),Object(O.jsx)("div",{className:"received-chats",children:null!==s?Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)("div",{className:"received-chats-img",children:Object(O.jsx)("img",{className:"chats-img",src:"chatgpt.png"})}),Object(O.jsx)("div",{className:"received-msg",children:Object(O.jsxs)("div",{className:"received-msg-inbox",children:[Object(O.jsx)("p",{children:s}),Object(O.jsx)("span",{className:"chat-time",children:p})]})})]}):null!==c?Object(O.jsx)(h,{}):Object(O.jsx)(O.Fragment,{})})]})})},m=function(e){var t=e.apiKey,c=Object(n.useState)([]),s=Object(i.a)(c,2),a=s[0],r=s[1],b=Object(n.useState)([]),d=Object(i.a)(b,2),h=d[0],m=d[1],f=Object(n.useState)([]),g=Object(i.a)(f,2),v=g[0],y=g[1],N=Object(n.useState)([]),w=Object(i.a)(N,2),S=w[0],C=w[1],k=Object(n.useState)(!1),F=Object(i.a)(k,2),A=(F[0],F[1],function(){var e=Object(l.a)(Object(j.a)().mark((function e(c){var n,s,a;return Object(j.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={"content-type":"multipart/form-data",Authorization:"Bearer ".concat(t)},(s=new FormData).append("file",c,"test.mp3"),s.append("model","whisper-1"),e.next=6,p.a.post("https://api.openai.com/v1/audio/transcriptions",s,{headers:n});case 6:return a=e.sent,console.log(a),console.log(a.data.text),e.abrupt("return",a.data.text);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());function E(e,t){return T.apply(this,arguments)}function T(){return(T=Object(l.a)(Object(j.a)().mark((function e(c,n){var s,a,r,i,l;return Object(j.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,A(n);case 3:return s=e.sent,console.log(s),m([].concat(Object(o.a)(h.slice(0,h.length)),[s])),a={"content-type":"application/json",Authorization:"Bearer ".concat(t)},r={messages:[{role:"user",content:s}],model:"gpt-3.5-turbo"},e.next=10,p.a.post("https://api.openai.com/v1/chat/completions",r,{headers:a});case 10:return i=e.sent,console.log(i),l=i.data.choices[0].message.content,C([].concat(Object(o.a)(S),[[c,s,l]])),e.abrupt("return",i.data.choices[0].message.content);case 17:e.prev=17,e.t0=e.catch(0),console.log(e.t0);case 20:case"end":return e.stop()}}),e,null,[[0,17]])})))).apply(this,arguments)}var D=function(){var e=Object(l.a)(Object(j.a)().mark((function e(t){var c,n;return Object(j.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=URL.createObjectURL(t),r([].concat(Object(o.a)(a),[c])),y([].concat(Object(o.a)(v),[null])),m([].concat(Object(o.a)(h),[null])),e.next=6,E(c,t);case 6:n=e.sent,y([].concat(Object(o.a)(v.slice(0,v.length)),[n]));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){console.log(S)}),[S]),Object(O.jsxs)("div",{className:"App",style:{marginTop:"30px"},children:[Object(O.jsx)("div",{className:"msg-container",children:a.map((function(e,t){return Object(O.jsx)(x,{audio:a[t],transcription:h[t],text:v[t]},t)}))}),Object(O.jsx)("div",{style:{position:"fixed",left:"50%",top:"95%",transform:"translate(-50%, -50%)",background:"#99ccff",maxWidth:"750px",width:"100%",height:"70px",borderRadius:"8px",boxShadow:"1px 1px"}}),Object(O.jsxs)("div",{style:{position:"fixed",left:"50%",top:"95%",transform:"translate(-50%, -50%)",display:"flex",justifyContent:"space-between",width:"300px"},children:[Object(O.jsx)(u.a,{onRecordingComplete:D}),Object(O.jsx)("button",{className:"circle-button",disabled:!1,onClick:function(){r([]),C([]),m([]),y([])},children:Object(O.jsx)("ion-icon",{name:"trash",style:{fontSize:"17px"}})})]})]})},f=function(e){var t=e.setApiKey,c=Object(n.useRef)();return Object(O.jsxs)("div",{className:"App",style:{marginTop:"30px"},children:[Object(O.jsx)("h2",{children:"Whisper + ChatGPT \u8853\u524d\u554f\u8a3a\u7cfb\u7d71"}),Object(O.jsxs)("span",{children:["Api Key : ",Object(O.jsx)("input",{type:"text",onKeyDown:function(e){console.log(e),"Enter"===e.key&&t(e.target.value)},ref:c})]}),Object(O.jsx)("button",{onClick:function(e){try{t(c.current.value)}catch(n){console.log(n)}},children:"\u78ba\u8a8d"})]})},g=function(e,t){var c=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"anonymous";Object(n.useEffect)((function(){var n=document.createElement("script");return n.src=e,n.async=c,t&&(n.integrity=t),n.crossOrigin=s,document.body.appendChild(n),function(){document.body.removeChild(n)}}),[e,t,c,s])};var v=function(){g("https://cdn.jsdelivr.net/npm/ionicons/dist/ionicons/ionicons.js");var e=Object(n.useState)(""),t=Object(i.a)(e,2),c=t[0],s=t[1];return Object(O.jsx)("div",{className:"App",style:{marginTop:"30px"},children:c.length?Object(O.jsx)(m,{apiKey:c}):Object(O.jsx)(f,{setApiKey:s})})},y=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,36)).then((function(t){var c=t.getCLS,n=t.getFID,s=t.getFCP,a=t.getLCP,r=t.getTTFB;c(e),n(e),s(e),a(e),r(e)}))};r.a.createRoot(document.getElementById("root")).render(Object(O.jsx)(s.a.StrictMode,{children:Object(O.jsx)(v,{})})),y()},9:function(e,t,c){}},[[33,1,2]]]);
//# sourceMappingURL=main.a66a1ffb.chunk.js.map