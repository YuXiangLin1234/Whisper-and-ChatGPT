(this.webpackJsonpchatgpt=this.webpackJsonpchatgpt||[]).push([[0],{10:function(e,t,n){},28:function(e,t,n){},34:function(e,t,n){"use strict";n.r(t);var c=n(2),a=n.n(c),r=n(17),s=n.n(r),i=(n(28),n(4)),o=(n(10),n(8)),u=n(5),l=n(6),j=n(18),p=n(35);function b(e){return e.toString().padStart(2,"0")}function h(e){return[b(e.getMonth()+1),b(e.getDate())].join("/")+" "+[b(e.getHours()),b(e.getMinutes()),b(e.getSeconds())].join(":")}function d(e){return O.apply(this,arguments)}function O(){return(O=Object(l.a)(Object(u.a)().mark((function e(t){var n,c;return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"gpt-3.5-turbo","https://api.openai.com/v1/chat/completions",e.prev=2,n={"content-type":"application/json",Authorization:"Bearer ".concat(t)},c={messages:[{role:"user",content:"Hello!"}],model:"gpt-3.5-turbo"},e.next=8,p.a.post("https://api.openai.com/v1/chat/completions",c,{headers:n});case 8:return e.sent,e.abrupt("return",!0);case 12:return e.prev=12,e.t0=e.catch(2),console.log(e.t0),e.abrupt("return",!1);case 16:case"end":return e.stop()}}),e,null,[[2,12]])})))).apply(this,arguments)}var v=n(1),m=function(){return Object(v.jsxs)("div",{className:"spinner",children:[Object(v.jsx)("div",{className:"bounce1"}),Object(v.jsx)("div",{className:"bounce2"}),Object(v.jsx)("div",{className:"bounce3"})]})},f=function(e){var t=e.audio,n=e.transcription,a=e.translation,r=e.chat,s=Object(c.useState)(""),o=Object(i.a)(s,2),u=(o[0],o[1]),l=Object(c.useState)(""),j=Object(i.a)(l,2),p=j[0],b=j[1],d=Object(c.useState)(""),O=Object(i.a)(d,2),f=O[0],x=O[1];return Object(c.useEffect)((function(){var e=new Date;u(h(e))}),[n]),Object(c.useEffect)((function(){var e=new Date;b(h(e))}),[a]),Object(c.useEffect)((function(){var e=new Date;x(h(e))}),[r]),Object(v.jsx)("div",{style:{margin:"20px"},children:Object(v.jsxs)("div",{className:"msg-page",children:[Object(v.jsxs)("div",{className:"sent-chats",children:[Object(v.jsxs)("div",{className:"sent-chats-msg",children:[null!==t?Object(v.jsx)("audio",{controls:"True",src:t}):Object(v.jsx)(m,{}),null!==n?Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)("p",{children:n}),null!==a?Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)("p",{style:{marginTop:"1px"},children:a}),Object(v.jsx)("span",{className:"chat-time",children:p})]}):Object(v.jsx)(m,{})]}):null!==t?Object(v.jsx)(m,{}):Object(v.jsx)(v.Fragment,{})]}),Object(v.jsx)("div",{className:"sent-chats-img",children:Object(v.jsx)("img",{className:"chats-img",src:"old.png"})})]}),Object(v.jsx)("div",{className:"received-chats",children:null!==r?Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)("div",{className:"received-chats-img",children:Object(v.jsx)("img",{className:"chats-img",src:"chatgpt.png"})}),Object(v.jsx)("div",{className:"received-msg",children:Object(v.jsxs)("div",{className:"received-msg-inbox",children:[Object(v.jsx)("p",{children:r}),Object(v.jsx)("span",{className:"chat-time",children:f})]})})]}):null!==a?Object(v.jsx)(m,{}):Object(v.jsx)(v.Fragment,{})})]})})},x=function(e){var t=e.apiKey,n=Object(c.useState)([]),a=Object(i.a)(n,2),r=a[0],s=a[1],b=Object(c.useState)([]),h=Object(i.a)(b,2),d=h[0],O=h[1],m=Object(c.useState)([]),x=Object(i.a)(m,2),g=x[0],y=x[1],w=Object(c.useState)([]),N=Object(i.a)(w,2),k=N[0],S=N[1],A=Object(c.useState)(!1),C=Object(i.a)(A,2),F=(C[0],C[1],"gpt-3.5-turbo"),E="https://api.openai.com/v1/chat/completions",T=function(){var e=Object(l.a)(Object(u.a)().mark((function e(n){var c,a,r,s;return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c={"content-type":"multipart/form-data",Authorization:"Bearer ".concat(t)},(a=new FormData).append("file",n,"audio.mp3"),a.append("model","whisper-1"),e.next=7,p.a.post("https://api.openai.com/v1/audio/transcriptions",a,{headers:c});case 7:return r=e.sent,s=r.data.text,e.abrupt("return",s);case 12:e.prev=12,e.t0=e.catch(0),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}();function D(e){return B.apply(this,arguments)}function B(){return(B=Object(l.a)(Object(u.a)().mark((function e(n){var c,a,r,s;return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c={"content-type":"application/json",Authorization:"Bearer ".concat(t)},a={messages:[{role:"system",content:"Translate from English to Traditional Chinese"},{role:"user",content:n}],model:F},e.next=6,p.a.post(E,a,{headers:c});case 6:return r=e.sent,s=r.data.choices[0].message.content,e.abrupt("return",s);case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})))).apply(this,arguments)}function K(e){return R.apply(this,arguments)}function R(){return(R=Object(l.a)(Object(u.a)().mark((function e(n){var c,a,r,s,i,o;return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(e.prev=0,c={"content-type":"application/json",Authorization:"Bearer ".concat(t)},a=[{role:"system",content:"You are a helpful assistant."}],console.log(g),r=0;r<g.length;r++)a.push({role:"user",content:g[r]}),a.push({role:"assistant",content:k[r]});return a.push({role:"user",content:n}),s={messages:a,model:F},e.next=9,p.a.post(E,s,{headers:c});case 9:return i=e.sent,o=i.data.choices[0].message.content,e.abrupt("return",o);case 14:e.prev=14,e.t0=e.catch(0),console.log(e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})))).apply(this,arguments)}function z(e,t){return L.apply(this,arguments)}function L(){return(L=Object(l.a)(Object(u.a)().mark((function e(t,n){var c,a,r;return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T(n);case 2:return c=e.sent,O([].concat(Object(o.a)(d),[c])),e.next=6,D(c);case 6:return a=e.sent,y([].concat(Object(o.a)(g),[a])),e.next=10,K(a);case 10:r=e.sent,S([].concat(Object(o.a)(k),[r]));case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var P=function(){var e=Object(l.a)(Object(u.a)().mark((function e(t){var n;return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=URL.createObjectURL(t),s([].concat(Object(o.a)(r),[n])),O([].concat(Object(o.a)(d),[null])),y([].concat(Object(o.a)(g),[null])),S([].concat(Object(o.a)(k),[null])),e.next=7,z(n,t);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(v.jsxs)("div",{className:"App",style:{marginTop:"30px"},children:[Object(v.jsx)("div",{className:"msg-container",children:r.map((function(e,t){return Object(v.jsx)(f,{audio:r[t],transcription:d[t],translation:g[t],chat:k[t]},t)}))}),Object(v.jsx)("div",{className:"bottom-line"}),Object(v.jsxs)("div",{className:"bottom-line-button",children:[Object(v.jsx)(j.a,{onRecordingComplete:P}),Object(v.jsx)("button",{className:"circle-button",disabled:!1,onClick:function(){s([]),O([]),y([]),S([])},children:Object(v.jsx)("ion-icon",{name:"trash",style:{fontSize:"17px"}})})]})]})},g=function(e){var t=e.setApiKey,n=Object(c.useRef)(),a=Object(c.useRef)(),r=function(){var e=Object(l.a)(Object(u.a)().mark((function e(n){var c;return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Enter"!==n.key){e.next=13;break}return e.prev=1,c=n.target.value,e.next=5,d(c);case 5:1==e.sent?t(n.target.value):a.current.style.visibility="visible",e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),a.current.style.visibility="visible",console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),s=function(){var e=Object(l.a)(Object(u.a)().mark((function e(c){var r;return Object(u.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=n.current.value,e.next=4,d(r);case 4:!0===e.sent?t(n.current.value):a.current.style.visibility="visible",e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),a.current.style.visibility="visible",console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}();return Object(v.jsxs)("div",{className:"App ask-key-container",children:[Object(v.jsx)("h2",{children:"Whisper & ChatGPT \u8853\u524d\u554f\u8a3a\u7cfb\u7d71"}),Object(v.jsxs)("span",{children:["Api Key : ",Object(v.jsx)("input",{type:"text",onKeyDown:r,ref:n})]}),Object(v.jsx)("button",{onClick:s,children:"\u78ba\u8a8d"}),Object(v.jsxs)("div",{className:"error",ref:a,style:{visibility:"hidden"},children:[Object(v.jsx)("h3",{style:{color:"red"},children:"Error!"}),Object(v.jsx)("p",{style:{color:"red"},children:"Please ensure that a correct api key is provided"})]})]})},y=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"anonymous";Object(c.useEffect)((function(){var c=document.createElement("script");return c.src=e,c.async=n,t&&(c.integrity=t),c.crossOrigin=a,document.body.appendChild(c),function(){document.body.removeChild(c)}}),[e,t,n,a])};var w=function(){y("https://cdn.jsdelivr.net/npm/ionicons/dist/ionicons/ionicons.js");var e=Object(c.useState)(""),t=Object(i.a)(e,2),n=t[0],a=t[1];return Object(v.jsx)("div",{className:"App",style:{marginTop:"30px"},children:n.length?Object(v.jsx)(x,{apiKey:n}):Object(v.jsx)(g,{setApiKey:a})})},N=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,36)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,r=t.getLCP,s=t.getTTFB;n(e),c(e),a(e),r(e),s(e)}))};s.a.createRoot(document.getElementById("root")).render(Object(v.jsx)(a.a.StrictMode,{children:Object(v.jsx)(w,{})})),N()}},[[34,1,2]]]);
//# sourceMappingURL=main.3b5c08cd.chunk.js.map