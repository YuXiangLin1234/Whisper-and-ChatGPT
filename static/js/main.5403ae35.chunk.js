(this["webpackJsonpWhisper-and-ChatGPT"]=this["webpackJsonpWhisper-and-ChatGPT"]||[]).push([[0],{10:function(e,t,n){},34:function(e,t,n){},46:function(e,t){},52:function(e,t,n){"use strict";n.r(t);var c=n(2),r=n.n(c),s=n(24),a=n.n(s),o=(n(34),n(5)),i=(n(10),n(4)),l=n(8),u=n(6),j=(n(22),n(25));function p(e){return e.toString().padStart(2,"0")}function b(e){return[p(e.getMonth()+1),p(e.getDate())].join("/")+" "+[p(e.getHours()),p(e.getMinutes()),p(e.getSeconds())].join(":")}var d=n(1),O=function(){return Object(d.jsxs)("div",{className:"spinner",children:[Object(d.jsx)("div",{className:"bounce1"}),Object(d.jsx)("div",{className:"bounce2"}),Object(d.jsx)("div",{className:"bounce3"})]})},h=function(e){var t=e.audio,n=e.transcription,r=e.translation,s=e.chat,a=Object(c.useState)(""),i=Object(o.a)(a,2),l=(i[0],i[1]),u=Object(c.useState)(""),j=Object(o.a)(u,2),p=j[0],h=j[1],f=Object(c.useState)(""),x=Object(o.a)(f,2),m=x[0],v=x[1];return Object(c.useEffect)((function(){var e=new Date;l(b(e))}),[n]),Object(c.useEffect)((function(){var e=new Date;h(b(e))}),[r]),Object(c.useEffect)((function(){var e=new Date;v(b(e))}),[s]),Object(d.jsx)("div",{style:{margin:"20px"},children:Object(d.jsxs)("div",{className:"msg-page",children:[Object(d.jsxs)("div",{className:"sent-chats",children:[Object(d.jsxs)("div",{className:"sent-chats-msg",children:[null!==t?Object(d.jsx)("audio",{controls:"True",src:t}):Object(d.jsx)(O,{}),null!==n?Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)("p",{children:n}),null!==r?Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)("p",{style:{marginTop:"1px"},children:r}),Object(d.jsx)("span",{className:"chat-time",children:p})]}):Object(d.jsx)(O,{})]}):null!==t?Object(d.jsx)(O,{}):Object(d.jsx)(d.Fragment,{})]}),Object(d.jsx)("div",{className:"sent-chats-img",children:Object(d.jsx)("img",{className:"chats-img",src:"old.png"})})]}),Object(d.jsx)("div",{className:"received-chats",children:null!==s?Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)("div",{className:"received-chats-img",children:Object(d.jsx)("img",{className:"chats-img",src:"chatgpt.png"})}),Object(d.jsx)("div",{className:"received-msg",children:Object(d.jsxs)("div",{className:"received-msg-inbox",children:[Object(d.jsx)("p",{children:s}),Object(d.jsx)("span",{className:"chat-time",children:m})]})})]}):null!==r?Object(d.jsx)(O,{}):Object(d.jsx)(d.Fragment,{})})]})})},f=(n(36),n(53)),x=(n(20),"gpt-3.5-turbo"),m="https://api.openai.com/v1/chat/completions",v="https://api.openai.com/v1/audio/transcriptions";function y(e){return g.apply(this,arguments)}function g(){return(g=Object(u.a)(Object(i.a)().mark((function e(t){var n,c;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n={"content-type":"application/json",Authorization:"Bearer ".concat(t)},c={messages:[{role:"user",content:"Hello!"}],model:x},e.next=6,f.a.post(m,c,{headers:n});case 6:return e.sent,e.abrupt("return",!0);case 10:return e.prev=10,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",!1);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}var w=function(){var e=Object(u.a)(Object(i.a)().mark((function e(t,n){var c,r,s,a;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c={"content-type":"multipart/form-data",Authorization:"Bearer ".concat(n)},(r=new FormData).append("file",t,"audio.mp3"),r.append("model","whisper-1"),r.append("language","zh"),e.next=8,f.a.post(v,r,{headers:c});case 8:return s=e.sent,a=s.data.text,e.abrupt("return",a);case 13:e.prev=13,e.t0=e.catch(0),console.log(e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t,n){return e.apply(this,arguments)}}();function N(e,t){return k.apply(this,arguments)}function k(){return(k=Object(u.a)(Object(i.a)().mark((function e(t,n){var c,r,s,a,o;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c={"content-type":"application/json",Authorization:"Bearer ".concat(n)},s={messages:r=[{role:"system",content:"Rewrite the sentence into a fluent Traditional Chinese one"},{role:"user",content:t}],model:x},e.next=6,f.a.post(m,s,{headers:c});case 6:return a=e.sent,console.log(r),o=a.data.choices[0].message.content,e.abrupt("return",o);case 12:e.prev=12,e.t0=e.catch(0),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})))).apply(this,arguments)}function S(e,t,n,c){return T.apply(this,arguments)}function T(){return(T=Object(u.a)(Object(i.a)().mark((function e(t,n,c,r){var s,a,o,l,u,j;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(e.prev=0,s={"content-type":"application/json",Authorization:"Bearer ".concat(r)},a=[{role:"system",content:"\u4f60\u662f\u4e00\u500b\u8a3a\u524d\u554f\u8a3a\u7cfb\u7d71\uff0c\u75c5\u4eba\u6703\u8ddf\u4f60\u8aaa\u4ed6\u76ee\u524d\u7684\u8eab\u9ad4\u72c0\u6cc1\uff0c                                                \u75c5\u4eba\u901a\u5e38\u6703\u8ddf\u4f60\u8b1b\u4ee5\u4e0b\u5e7e\u4ef6\u4e8b\u60c5:\n\n\u767c\u75c5\uff1a\u4ec0\u9ebc\u6642\u5019\u958b\u59cb                                                \u6ce8\u610f\u5230\u6709\u75c7\u72c0\u7522\u751f\uff1f\u8a98\u767c\u539f\u56e0\uff1a\u75c7\u72c0\u958b\u59cb\u51fa\u73fe\u7684\u6642\u9593\u9ede\u9644\u8fd1\uff0c                                                \u75c5\u4eba\u5728\u4ec0\u9ebc\u74b0\u5883\u505a\u4e86\u54ea\u4e9b\u4e8b\u60c5\uff1f\u6027\u8cea\uff1a\u75c7\u72c0\u51fa\u73fe\u6642\u7684\u611f\u89ba\u3001                                                \u75c7\u72c0\u7684\u7279\u5fb5\u75c7\u72c0\u6563\u5e03\uff1a\u51fa\u73fe\u75c7\u72c0\u7684\u90e8\u4f4d\u662f\u5426\u6539\u8b8a\u3001\u6216\u8005\u96a8\u8457                                                \u8eab\u9ad4\u7684\u79fb\u52d5\u800c\u6709\u8b8a\u5316\uff1f\u56b4\u91cd\u7a0b\u5ea6\uff1a\u75c7\u72c0\u4f55\u6642\u6700\u56b4\u91cd\uff1f\u6709\u591a\u56b4\u91cd\uff1f                                                \n\n\u8acb\u4f60\u5229\u7528\u7372\u5f97\u7684\u8a0a\u606f\uff0c\u4f86\u5efa\u7acb\u770b\u8a3a\u76ee\u6a19\uff0c\u53ef\u4ee5\u5f9e\u63d0\u51fa\u958b\u653e\u5f0f                                                \u7684\u554f\u984c\u958b\u59cb\uff0c\u5982\u679c\u4e0a\u8ff0\u95dc\u65bc\u767c\u75c5\u3001\u8a98\u767c\u539f\u56e0\u3001\u6027\u8cea\u3001\u75c7\u72c0\u6563\u5e03\u3001                                                \u56b4\u91cd\u7a0b\u5ea6\u6709\u4e0d\u6e05\u695a\u7684\u5730\u65b9\uff0c\u4e5f\u53ef\u4ee5\u8acb\u75c5\u4eba\u56de\u7b54\uff0c\u7136\u5f8c\u89c0\u5bdf\u75c5\u4eba\u7684                                                \u56de\u8986\uff0c\u4e26\u7528\u7e41\u9ad4\u4e2d\u6587\u7d66\u51fa\u5efa\u8b70\u3002"}],console.log(n),o=0;o<n.length;o++)a.push({role:"user",content:n[o]}),a.push({role:"assistant",content:c[o]});return a.push({role:"user",content:t}),console.log(a),l={messages:a,model:x},e.next=10,f.a.post(m,l,{headers:s});case 10:return u=e.sent,j=u.data.choices[0].message.content,e.abrupt("return",j);case 15:e.prev=15,e.t0=e.catch(0),console.log(e.t0);case 18:case"end":return e.stop()}}),e,null,[[0,15]])})))).apply(this,arguments)}var A=function(e){var t=e.apiKey,n=(e.hfToken,Object(c.useState)(!1)),r=Object(o.a)(n,2),s=r[0],a=r[1],p=Object(c.useState)([]),b=Object(o.a)(p,2),f=b[0],x=b[1],m=Object(c.useState)([]),v=Object(o.a)(m,2),y=v[0],g=v[1],k=Object(c.useState)([]),T=Object(o.a)(k,2),A=T[0],C=T[1],E=Object(c.useState)([]),F=Object(o.a)(E,2),R=F[0],D=F[1],K=Object(c.useState)(!1),P=Object(o.a)(K,2);P[0],P[1];function z(e,t){return B.apply(this,arguments)}function B(){return(B=Object(u.a)(Object(i.a)().mark((function e(n,c){var r,s,a;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w(c,t);case 2:return r=e.sent,g([].concat(Object(l.a)(y),[r])),e.next=6,N(r,t);case 6:return s=e.sent,C([].concat(Object(l.a)(A),[s])),e.next=10,S(s,A,R,t);case 10:a=e.sent,D([].concat(Object(l.a)(R),[a]));case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var H=function(){var e=Object(u.a)(Object(i.a)().mark((function e(t){var n;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=URL.createObjectURL(t),x([].concat(Object(l.a)(f),[n])),g([].concat(Object(l.a)(y),[null])),C([].concat(Object(l.a)(A),[null])),D([].concat(Object(l.a)(R),[null])),e.next=7,z(n,t);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(c.useEffect)((function(){a(!0)}),[]),Object(d.jsx)("div",{className:"App",style:{marginTop:"30px"},children:s?Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)("div",{className:"msg-container",children:f.map((function(e,t){return Object(d.jsx)(h,{audio:f[t],transcription:y[t],translation:A[t],chat:R[t]},t)}))}),Object(d.jsx)("div",{className:"bottom-line"}),Object(d.jsxs)("div",{className:"bottom-line-button",children:[Object(d.jsx)(j.a,{onRecordingComplete:H}),Object(d.jsx)("button",{className:"circle-button",disabled:!1,onClick:function(){x([]),g([]),C([]),D([])},children:Object(d.jsx)("ion-icon",{name:"trash",style:{fontSize:"17px"}})})]})]}):Object(d.jsxs)("div",{className:"center",children:[Object(d.jsx)("h2",{children:"Wait for model loading"}),Object(d.jsx)(O,{})]})})},C=function(e){var t=e.setApiKey,n=e.setHfToken,r=Object(c.useRef)(),s=Object(c.useRef)(),a=Object(c.useRef)(),o=Object(c.useRef)(),l=Object(c.useRef)(),j=function(){var e=Object(u.a)(Object(i.a)().mark((function e(){var c,u,j;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,c=s.current.value,u=r.current.value,0!==c.length&&0!==u.length){e.next=10;break}return a.current.style.display="inline",o.current.style.display="none",l.current.style.display="none",e.abrupt("return");case 10:a.current.style.display="none";case 11:return e.next=13,y(c);case 13:j=e.sent,!0,!0===j?(t(c),n(u),o.current.style.display="none",l.current.style.display="none"):(o.current.style.display=!1===j?"inline":"none",l.current.style.display="none"),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(0),console.log(e.t0);case 21:case"end":return e.stop()}}),e,null,[[0,18]])})));return function(){return e.apply(this,arguments)}}(),p=function(){var e=Object(u.a)(Object(i.a)().mark((function e(t){return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"Enter"===t.key&&j();case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=Object(u.a)(Object(i.a)().mark((function e(t){return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:j();case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(d.jsxs)("div",{className:"App ask-key-container",children:[Object(d.jsx)("h2",{children:"\u8a3a\u524d\u554f\u8a3a\u7cfb\u7d71"}),Object(d.jsx)("br",{}),Object(d.jsx)("br",{}),Object(d.jsxs)("div",{className:"ask-key-component",children:[Object(d.jsxs)("span",{children:["OpenAI Api Key : \xa0 \u2003\xa0",Object(d.jsx)("input",{type:"text",onKeyDown:p,ref:s})]}),Object(d.jsx)("br",{}),Object(d.jsx)("br",{}),Object(d.jsxs)("span",{children:["Huggingface Token : \xa0",Object(d.jsx)("input",{type:"text",onKeyDown:p,ref:r})]})]}),Object(d.jsx)("br",{}),Object(d.jsx)("br",{}),Object(d.jsx)("button",{onClick:b,children:"\u78ba\u8a8d"}),Object(d.jsxs)("div",{className:"error",ref:a,style:{display:"none"},children:[Object(d.jsx)("h3",{style:{color:"red"},children:"Error!"}),Object(d.jsx)("p",{style:{color:"red"},children:"Please ensure that both two input box are filled"})]}),Object(d.jsxs)("div",{className:"error",ref:o,style:{display:"none"},children:[Object(d.jsx)("h3",{style:{color:"red"},children:"Error!"}),Object(d.jsx)("p",{style:{color:"red"},children:"Please ensure that a correct OpenAI apikey is provided"})]}),Object(d.jsxs)("div",{className:"error",ref:l,style:{display:"none"},children:[Object(d.jsx)("h3",{style:{color:"red"},children:"Error!"}),Object(d.jsx)("p",{style:{color:"red"},children:"Please ensure that a correct huggingface token is provided"})]})]})},E=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"anonymous";Object(c.useEffect)((function(){var c=document.createElement("script");return c.src=e,c.async=n,t&&(c.integrity=t),c.crossOrigin=r,document.body.appendChild(c),function(){document.body.removeChild(c)}}),[e,t,n,r])};var F=function(){E("https://cdn.jsdelivr.net/npm/ionicons/dist/ionicons/ionicons.js");var e=Object(c.useState)(""),t=Object(o.a)(e,2),n=t[0],r=t[1],s=Object(c.useState)(""),a=Object(o.a)(s,2),i=a[0],l=a[1];return Object(d.jsx)("div",{className:"App",style:{marginTop:"30px"},children:n.length&&i.length?Object(d.jsx)(A,{apiKey:n,hfToken:i}):Object(d.jsx)(C,{setApiKey:r,setHfToken:l})})},R=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,54)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,s=t.getLCP,a=t.getTTFB;n(e),c(e),r(e),s(e),a(e)}))};a.a.createRoot(document.getElementById("root")).render(Object(d.jsx)(r.a.StrictMode,{children:Object(d.jsx)(F,{})})),R()}},[[52,1,2]]]);
//# sourceMappingURL=main.5403ae35.chunk.js.map